---
talk-title: " Cooperative learning for multiview analysis"
author: "Tony Liang"
course: "BMEG524"
talk-date: "March 18, 2024"
format: revealjs
knitr: 
  opts_chunk: 
    R.options: 
      knitr.table.html.attr: "quarto-disable-processing=true"
---

```{r}
#| echo: false
#| include: false
#| message: false
#| warning: false

# Setup block
library(tidyverse)
library(kableExtra)
library(knitr)
```

<!--- This looks very ugly TODO: FIX THIS --->

<br>
<br>

::: {.primary .bold .justify-center .f-subheadline .tj .flex}

{{< meta talk-title  >}}

:::

<br>

<br>


::: {.f1 .bold .tc}

<br>


{{< meta author >}} 

<br>

{{< meta course >}}


{{< meta talk-date >}}

::: 



## Multiomics data

Different types of molecular measurements (omics) from common set of samples

:::: {.columns}


<!-- ::: {.column width="10%"}
::: -->

::: {.column width="28%"}

<br>

- Genomics
- Proteomics
- Metabolomics
- And more

:::

::: {.column width="72%"} 
```{r}
#| echo: false
#| label: "fig-fusion"
#| fig-cap: "Multiomics data fusion source"
knitr::include_graphics("assets/fig1-a.png")
```

:::

::::

## Types of fusion strategy

- Early

  - Merge multiple data views into single representation than feed to model

- Late
  
  - Individual models fit on distinct view, then predictions of thes models are combined into final predictor

- Mixing of both

Analogy to LASSO, Ridge or elastic-net

## Paper

The paper is from @ding2022cooperative, supervised learning algorithm that focus on disease classification and treatment response prediction

::: {.fragment}

- Addresses "fusion" in data-adaptive manner
- Combines different omics together, they call this "view"


:::


## Input data for the algorithm

Takes in data from various modalities mentioned earlier, integrating heterogenous features on common set of observations (say patients)

::: {.callout-note}

# Example

Input from same patients:

- RNA expression
- DNA-methylation measurements

Predict cancer outcomes

:::

::: {.fragment}

1. Both data views potentially have prognostic value
2. Two view share some underlysing relationship with each other

:::

::: {.notes}

- DNA methylation regulates gene expression --> could repress expression tumor suppresor genes  or promote expression of oncogenes

:::


## When would you want to do this analysis

- Multiple modalities from same biological samples exist, specially when they share some underlying relationship in their signals

- Making discoveries that are hidden in data analyses of single modality

- Achieving more accurate predictions of the outcome variable


## Motivation and background 3

::: {.callout-note}

What does it tell you?

:::

Using this algorithm, we could model outcome of interest better by fusing different data views




## Overview structure of Cooperative Learning
<!-- 
::: {.callout-note}
- What is the theoretical underpinnings of the approach
::: -->

```{r}
#| label: "fig-underpinnig"
#| fig-cap: "Types of approach of omics integration"
knitr::include_graphics("assets/fig1-b.png")
```

::: {.notes}

- When $\rho = 0$, it yields early fusion

- When $\rho = 1$, it yields late fusion

:::

## Algorithm 2

::: {.callout-note}
- How does it work?
:::

## Algorithm 3


::: {.callout-note}

What considerations are there when applying it?

:::

- Requires omics from same providers
- Runtime complexity is high due to iterative nature of the algorithm
- Works best if the omics itself are related each other



## Quality control measures 1

::: {.callout-note}
- How can you determine whether it worked?
:::

## What happens if data quality is not good?

When the views are not correlated, this could be very [bad]{.secondary}^[Appendix Fig S3 from @ding2022cooperative]

```{r}
#| echo: false
#| fig-cap: "Both X, Z contains signal, no correlation"
knitr::include_graphics("assets/app_s3c-a.png")
```

## What happens if data quality is not good?

When the views are not correlated, this could be very [bad]{.secondary}^[Appendix Fig S3 from @ding2022cooperative]

```{r}
#| echo: false
#| layout-ncol: 2
#| fig-cap: 
#| - "Both X, Z contains signal, no correlation"
#| - "Only X contains signal"
knitr::include_graphics("assets/app_s3c-a.png")
knitr::include_graphics("assets/app_s3c-c.png")
```

## What happens if data quality is not good?

When the views are not correlated, this could be very [bad]{.secondary}^[Appendix Fig S3 from @ding2022cooperative]

```{r}
#| echo: false
#| layout-ncol: 3
#| fig-cap: 
#| - "Both X, Z contains signal"
#| - "X with more signal than Z"
#| - "Only X contains signal"
knitr::include_graphics("assets/app_s3c-a.png")
knitr::include_graphics("assets/app_s3c-b.png")
knitr::include_graphics("assets/app_s3c-c.png")
```

## Case Study on Labor Onset Prediction {.smaller}

<!-- ::: {.callout-note}
- Are there special analysis considerations?
::: -->

Authors performed their algorithm on a labor dataset from another study^[@stelzer2021integrated]

:::: {.columns}

::: {.column width="35%"}

- Measured proteome and metabolome from $53$ patients of a longitudinal study

- [Predict time to spontaneous labor]{.fourth-colour}

- The other study used LASSO^[@tibshirani1996regression] for each omics individually (like in late fussion)

:::

::: {.column width="5%"} 

:::

::: {.fragment .column width="60%"}

```{r}
#| echo: false
#| label: "tbl-labor"
# Then the kable
sub_header <- c("", "Mean", "SD", "Mean", "SD", "Mean")
data <- read.csv("data/labor.csv")
# The kable goes here
data %>% 
  kable(align = "c", 
        col.names = sub_header,
        table.attr = "quarto-disable-processing=true"
        ) %>%
  add_header_above(c("Methods", "Test MSE" = 2, "Relative to early fusion" = 2, "Numbers of features selected")) %>% 
  row_spec(5, bold = T, color="#a8201a") %>%
  kable_styling(c("striped", "bordered"), full_width = FALSE)
```

:::

::::



::: {.notes}

- 1,322 proteins, and the metabolomics data contained measurements for 3,529 metabolites

- split the dataset of 53 patients into training and test sets of 40 and 13 patients, respectively

- from blood samples, during the last $120$ day of pregnancy

:::


## Analysis 2

::: {.callout-note}
- Controlling for sources of bias
:::

## Analysis 3

::: {.callout-note}
- Insights into analysis?
:::

<!-- ```{r}
r1 <- c("Separate Proteomics", 475.51, 80.89, 69.14, 81.44, 26)
r2 <- c("Separate Metabolomics", 381.13, 36.88, -25.24, 30.91, 11)
r3 <- c("Early fusion", 406.37, )
``` -->

## Analysis 4

::: {.callout-note}
- What is the biological interpretation?
:::


## {#end}

<br>
<br>

<br>
<br>

::: {.closing}

Questions?

:::



## {#reference}